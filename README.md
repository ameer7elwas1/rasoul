# نظام إدارة الأقساط - مجموعة رسول الرحمة

نظام شامل لإدارة أقساط المدارس والروضات مع إمكانيات متقدمة للتواصل والإشعارات.

## المميزات الرئيسية

### 1. نظام إدارة الأقساط
- **4 دفعات** لكل طالب سنوياً
- **حساب الخصومات التلقائي**:
  - خصم 5% لطالبين من نفس العائلة
  - خصم 10% لثلاثة طلاب أو أكثر من نفس العائلة
- تتبع حالة كل دفعة (مدفوع / مدفوع جزئياً / غير مدفوع)
- سجل كامل للمدفوعات مع رقم الإيصال وطريقة الدفع

### 2. لوحات التحكم
- **لوحة تحكم للمدارس**: كل مدرسة تفتح على حدة مع بياناتها الخاصة
- **لوحة تحكم رئيس مجلس الإدارة**: يشاهد جميع المدارس والإحصائيات الشاملة

### 3. نظام المحادثة المباشرة
- محادثة مباشرة بين كل مدرسة ورئيس مجلس الإدارة
- إشعارات عند وصول رسائل جديدة
- واجهة محادثة سهلة الاستخدام

### 4. نظام الإشعارات
- إرسال إشعارات من رئيس مجلس الإدارة إلى المدارس
- إمكانية إرسال إشعارات لجميع المدارس أو مدرسة محددة
- أنواع مختلفة من الإشعارات (معلومات، نجاح، تحذير، خطأ)

### 5. نظام إرسال رسائل واتساب
- إرسال تذكيرات واتساب لأولياء الأمور
- رسائل مخصصة لكل طالب
- إمكانية إرسال رسائل جماعية
- سجل كامل للرسائل المرسلة

### 6. الإعدادات
- إعدادات الأقساط (المبالغ السنوية، عدد الدفعات)
- إعدادات الخصومات
- إعدادات واتساب
- إعدادات الأمان

## البنية التقنية

### الملفات الرئيسية

```
رسول الرحمة/
├── index.html                    # صفحة تسجيل الدخول
├── school-dashboard.html         # لوحة تحكم المدرسة
├── admin-dashboard.html          # لوحة تحكم رئيس مجلس الإدارة
├── school-dashboard.js           # منطق لوحة تحكم المدرسة
├── admin-dashboard.js            # منطق لوحة تحكم الرئيس
├── students-management.js        # إدارة الطلاب
├── installments-management.js    # إدارة الأقساط
├── messages-system.js            # نظام المحادثة
├── notifications-system.js       # نظام الإشعارات
├── settings-page.js             # صفحة الإعدادات
├── installments_schema.sql       # جداول قاعدة البيانات الإضافية
└── README.md                     # هذا الملف
```

### قاعدة البيانات

النظام يستخدم Supabase كقاعدة بيانات. الجداول الرئيسية:

- **schools**: المدارس والروضات
- **students**: الطلاب
- **users**: المستخدمين
- **payments**: سجل المدفوعات
- **conversations**: المحادثات
- **conversation_messages**: رسائل المحادثات
- **admin_notifications**: إشعارات رئيس مجلس الإدارة
- **whatsapp_messages**: رسائل واتساب المرسلة
- **system_settings**: الإعدادات العامة

## التثبيت والإعداد

### 1. إعداد قاعدة البيانات

قم بتشغيل ملف SQL التالي في Supabase:

**`database_complete.sql`** - ملف واحد شامل يحتوي على جميع الجداول، البيانات الأولية، والإعدادات

### 2. إعداد الملفات

**مهم جداً**: يجب تحديث ملف `config.js` بإعدادات Supabase الخاصة بك:

1. افتح ملف `config.js` في مجلد المشروع
2. استبدل `YOUR_SUPABASE_URL_HERE` بـ URL الخاص بك من Supabase
3. استبدل `YOUR_SUPABASE_ANON_KEY_HERE` بـ ANON KEY الخاص بك من Supabase
4. احفظ الملف

**ملاحظة**: ملف `config.js` موجود في نفس مجلد المشروع (ليس في المجلد الأب)

الملفات المطلوبة:
- `config.js` - إعدادات Supabase (يجب تحديثه)
- `utils.js` - الدوال المساعدة (يجب أن يكون في المجلد الأب)

### 3. المستخدمين الافتراضيين

بعد تشغيل SQL، ستكون لديك الحسابات التالية:

**رئيس مجلس الإدارة:**
- اسم المستخدم: `admin`
- كلمة المرور: `master123`

**المدارس:**
- روضة رسول الرحمة: `rawda` / `rawda123`
- مدرسة رسول الرحمة: `rasoul` / `rasoul123`
- مدرسة نور الرحمة: `noor` / `noor123`
- مدرسة نبي الرحمة: `nabi` / `nabi123`
- ثانوية رسول الرحمة: `thanawiya` / `thanawiya123`

⚠️ **مهم**: قم بتغيير كلمات المرور الافتراضية فوراً!

## الاستخدام

### تسجيل الدخول

1. افتح `index.html` في المتصفح
2. أدخل اسم المستخدم وكلمة المرور
3. سيتم توجيهك تلقائياً إلى لوحة التحكم المناسبة

### إضافة طالب جديد

1. من لوحة تحكم المدرسة، اذهب إلى قسم "الطلاب"
2. اضغط على "إضافة طالب"
3. املأ البيانات المطلوبة
4. سيتم حساب الخصم والأقساط تلقائياً

### إضافة دفعة

1. من قائمة الطلاب، اضغط على زر "دفع" بجانب الطالب
2. أو اذهب إلى قسم "الأقساط" واختر الطالب
3. اضغط على "دفع" بجانب الدفعة المطلوبة
4. أدخل المبلغ وطريقة الدفع

### إرسال إشعار

1. من لوحة تحكم رئيس مجلس الإدارة، اذهب إلى "الإشعارات"
2. اضغط على "إرسال إشعار"
3. املأ العنوان والرسالة
4. اختر المدارس المستهدفة (أو اتركه فارغاً لجميع المدارس)

### إرسال رسالة واتساب

1. من قائمة الطلاب، اضغط على زر واتساب
2. سيتم فتح واتساب مع رسالة جاهزة
3. يمكنك تعديل الرسالة قبل الإرسال

## الأمان

- كلمات المرور مشفرة باستخدام bcrypt
- نظام حماية من محاولات الدخول المتكررة
- انتهاء الجلسة تلقائياً بعد فترة من عدم النشاط
- Row Level Security (RLS) في Supabase

## الدعم الفني

للمساعدة والدعم، يرجى التواصل مع فريق التطوير.

## الترخيص

هذا النظام مخصص لمجموعة رسول الرحمة.

---

**تم التطوير بواسطة**: فريق تطوير مجموعة رسول الرحمة  
**الإصدار**: 1.0.0  
**تاريخ التحديث**: 2025

